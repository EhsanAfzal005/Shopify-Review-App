<div id="mean3-reviews-container" data-product-id="{{ product.id }}">
  <h2>Customer Reviews</h2>
  
  <!-- Summary Bar (populated by JS) -->
  <div id="mean3-summary-bar" class="mean3-summary-bar" style="display: none;">
    <div class="mean3-summary-left">
      <div class="mean3-summary-rating">
        <span class="mean3-big-rating">0.0</span>
        <span class="mean3-out-of">/5</span>
      </div>
      <div class="mean3-summary-stars"></div>
      <div class="mean3-summary-count">Based on <span>0</span> reviews</div>
    </div>
    <div class="mean3-summary-right">
      <div class="mean3-distribution"></div>
    </div>
  </div>

  <div id="mean3-reviews-list">
    <p>Loading reviews...</p>
  </div>
  
  <div id="mean3-review-form-container">
    <h3>Write a Review</h3>
    <form id="mean3-review-form">
      <input type="hidden" name="productId" value="{{ product.id }}">
      <input type="hidden" name="rating" id="rating-value" value="5">
      
      <!-- Interactive Star Picker -->
      <div class="form-group">
        <label>Rating</label>
        <div class="mean3-star-picker" id="star-picker">
          <span class="star" data-rating="1">â˜…</span>
          <span class="star" data-rating="2">â˜…</span>
          <span class="star" data-rating="3">â˜…</span>
          <span class="star" data-rating="4">â˜…</span>
          <span class="star" data-rating="5">â˜…</span>
        </div>
        <span class="mean3-rating-text" id="rating-text">Excellent</span>
      </div>
      
      <div class="form-group">
        <label for="customerName">Name</label>
        <input type="text" name="customerName" id="customerName" required placeholder="Your Name">
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" name="email" id="email" required placeholder="your@email.com">
      </div>
      
      <div class="form-group">
        <label for="comment">Review</label>
        <textarea name="comment" id="comment" required placeholder="Share your experience"></textarea>
      </div>

      <!-- Photo Upload -->
      <div class="form-group">
        <label for="photos">Add Photos (optional)</label>
        <div class="mean3-photo-upload">
          <input type="file" id="photos" accept="image/*" multiple style="display: none;">
          <button type="button" class="mean3-upload-btn" id="photo-btn">ðŸ“· Add Photos</button>
          <span class="mean3-photo-hint">Up to 5 photos, max 2MB each</span>
        </div>
        <div class="mean3-photo-preview" id="photo-preview"></div>
      </div>
      
      <button type="submit">Submit Review</button>
    </form>
    <div id="mean3-form-message"></div>
  </div>
</div>

<!-- Photo Lightbox Modal -->
<div id="mean3-lightbox" class="mean3-lightbox" style="display: none;">
  <span class="mean3-lightbox-close">&times;</span>
  <img id="mean3-lightbox-img" src="" alt="Full size photo">
</div>

<script src="{{ 'reviews.js' | asset_url }}" defer></script>
<link rel="stylesheet" href="{{ 'reviews.css' | asset_url }}">

<style>
  #mean3-reviews-container {
    --mean3-star-color: {{ block.settings.star_color }};
    --mean3-button-bg: {{ block.settings.button_bg }};
    --mean3-button-text: {{ block.settings.button_text }};
    --mean3-text-color: {{ block.settings.text_color }};
    --mean3-primary-color: {{ block.settings.primary_color }};
  }
</style>

{% schema %}
{
  "name": "Customer Reviews",
  "target": "section",
  "settings": [
    {
      "type": "color",
      "id": "star_color",
      "label": "Star Rating Color",
      "default": "#ffce00"
    },
    {
      "type": "color",
      "id": "button_bg",
      "label": "Button Background Color",
      "default": "#D32F2F"
    },
    {
      "type": "color",
      "id": "button_text",
      "label": "Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#333333"
    },
     {
      "type": "color",
      "id": "primary_color",
      "label": "Primary/Accent Color",
      "default": "#D32F2F"
    }
  ]
}
{% endschema %}
